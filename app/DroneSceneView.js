"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var nativescript_ar_1 = require("nativescript-ar");
Object.assign(global, {
    SCNVector3Make: function (x, y, z) {
        return new SCNVector3({ x: x, y: y, z: z });
    }
});
var DroneSceneView = /** @class */ (function (_super) {
    __extends(DroneSceneView, _super);
    function DroneSceneView() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    DroneSceneView.prototype.setupDrone = function () {
        this.sceneView.scene = SCNScene.sceneNamed("Assets.scnassets/Drone.scn");
        this.helicopterNode = this.sceneView.scene.rootNode.childNodeWithNameRecursively("helicopter", false);
        this.helicopterNode.transform = SCNMatrix4Mult(this.helicopterNode.transform, SCNMatrix4MakeRotation(Math.PI / 2, 1, 0, 0));
        this.helicopterNode.position = SCNVector3Make(this.helicopterNode.position.x, this.helicopterNode.position.y, this.helicopterNode.position.z - 1);
        this.blade1Node = this.helicopterNode.childNodeWithNameRecursively("Rotor_R_2", true);
        this.blade2Node = this.helicopterNode.childNodeWithNameRecursively("Rotor_L_2", true);
        this.rotorR = this.blade1Node.childNodeWithNameRecursively("Rotor_R", true);
        this.rotorL = this.blade2Node.childNodeWithNameRecursively("Rotor_L", true);
        this.styleDrone();
        this.spinBlades();
    };
    DroneSceneView.prototype.styleDrone = function () {
        var bodyMaterial = SCNMaterial.new();
        bodyMaterial.diffuse.contents = UIColor.colorWithRedGreenBlueAlpha(63 / 255, 86 / 255, 247 / 255, 1);
        this.helicopterNode.geometry.materials = NSArray.arrayWithArray([bodyMaterial]);
        //a node might have geometry of null
        // this.sceneView.scene.rootNode.geometry.materials = NSArray.arrayWithArray([bodyMaterial]);
        var bladeMaterial = SCNMaterial.new();
        bladeMaterial.diffuse.contents = UIColor.grayColor;
        var rotorMaterial = SCNMaterial.new();
        rotorMaterial.diffuse.contents = UIColor.whiteColor;
        this.blade1Node.geometry.materials = NSArray.arrayWithArray([rotorMaterial]);
        this.blade2Node.geometry.materials = NSArray.arrayWithArray([rotorMaterial]);
        this.rotorR.geometry.materials = NSArray.arrayWithArray([bladeMaterial]);
        this.rotorL.geometry.materials = NSArray.arrayWithArray([bladeMaterial]);
    };
    DroneSceneView.prototype.spinBlades = function () {
        var rotate = SCNAction.rotateByXYZDuration(0, 0, 200, 0.5);
        var moveSequence = SCNAction.sequence(NSArray.arrayWithArray([rotate]));
        var moveLoop = SCNAction.repeatActionForever(moveSequence);
        this.rotorL.runAction(moveLoop);
        this.rotorR.runAction(moveLoop);
    };
    DroneSceneView.prototype.changeAltitude = function (value) {
        SCNTransaction.begin();
        SCNTransaction.animationDuration = 0.5;
        this.helicopterNode.position = SCNVector3Make(this.helicopterNode.position.x, value, this.helicopterNode.position.z);
        SCNTransaction.commit();
    };
    DroneSceneView.prototype.moveLeft = function () {
        SCNTransaction.begin();
        SCNTransaction.animationDuration = 0.5;
        this.helicopterNode.position = SCNVector3Make(this.helicopterNode.position.x - 0.5, this.helicopterNode.position.y, this.helicopterNode.position.z);
        this.blade2Node.runAction(SCNAction.rotateByXYZDuration(0.3, -0.1, 0, 1.5));
        this.blade1Node.runAction(SCNAction.rotateByXYZDuration(0.3, 0, 0, 1.5));
        SCNTransaction.commit();
        this.blade2Node.runAction(SCNAction.rotateByXYZDuration(-0.3, 0.1, 0, 0.25));
        this.blade1Node.runAction(SCNAction.rotateByXYZDuration(-0.3, 0, 0, 0.25));
    };
    DroneSceneView.prototype.moveRight = function () {
        SCNTransaction.begin();
        SCNTransaction.animationDuration = 0.5;
        this.helicopterNode.position = SCNVector3Make(this.helicopterNode.position.x + 0.5, this.helicopterNode.position.y, this.helicopterNode.position.z);
        this.blade2Node.runAction(SCNAction.rotateByXYZDuration(0.3, -0.1, 0, 1.5));
        this.blade1Node.runAction(SCNAction.rotateByXYZDuration(0.3, 0, 0, 1.5));
        SCNTransaction.commit();
        this.blade2Node.runAction(SCNAction.rotateByXYZDuration(-0.3, 0.1, 0, 0.25));
        this.blade1Node.runAction(SCNAction.rotateByXYZDuration(-0.3, 0, 0, 0.25));
    };
    DroneSceneView.prototype.moveForward = function () {
        SCNTransaction.begin();
        SCNTransaction.animationDuration = 0.5;
        this.helicopterNode.position = SCNVector3Make(this.helicopterNode.position.x, this.helicopterNode.position.y, this.helicopterNode.position.z - 0.5);
        this.blade2Node.runAction(SCNAction.rotateByXYZDuration(0.3, -0.1, 0, 1.5));
        this.blade1Node.runAction(SCNAction.rotateByXYZDuration(0.3, 0, 0, 1.5));
        SCNTransaction.commit();
        this.blade2Node.runAction(SCNAction.rotateByXYZDuration(-0.3, 0.1, 0, 0.25));
        this.blade1Node.runAction(SCNAction.rotateByXYZDuration(-0.3, 0, 0, 0.25));
    };
    DroneSceneView.prototype.moveBack = function () {
        SCNTransaction.begin();
        SCNTransaction.animationDuration = 0.5;
        this.helicopterNode.position = SCNVector3Make(this.helicopterNode.position.x, this.helicopterNode.position.y, this.helicopterNode.position.z + 0.5);
        this.blade2Node.runAction(SCNAction.rotateByXYZDuration(0.3, -0.1, 0, 1.5));
        this.blade1Node.runAction(SCNAction.rotateByXYZDuration(0.3, 0, 0, 1.5));
        SCNTransaction.commit();
        this.blade2Node.runAction(SCNAction.rotateByXYZDuration(-0.3, 0.1, 0, 0.25));
        this.blade1Node.runAction(SCNAction.rotateByXYZDuration(-0.3, 0, 0, 0.25));
    };
    return DroneSceneView;
}(nativescript_ar_1.AR));
exports.DroneSceneView = DroneSceneView;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRHJvbmVTY2VuZVZpZXcuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJEcm9uZVNjZW5lVmlldy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLG1EQUFtQztBQUVuQyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRTtJQUNsQixjQUFjLFlBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDO1FBQ3RCLE1BQU0sQ0FBQyxJQUFJLFVBQVUsQ0FBQyxFQUFFLENBQUMsR0FBQSxFQUFFLENBQUMsR0FBQSxFQUFFLENBQUMsR0FBQSxFQUFFLENBQUMsQ0FBQztJQUNuQyxDQUFDO0NBQ0osQ0FBQyxDQUFBO0FBRUY7SUFBb0Msa0NBQUU7SUFBdEM7O0lBK0ZBLENBQUM7SUF4RkcsbUNBQVUsR0FBVjtRQUNJLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxHQUFHLFFBQVEsQ0FBQyxVQUFVLENBQUMsNEJBQTRCLENBQUMsQ0FBQztRQUN6RSxJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyw0QkFBNEIsQ0FBQyxZQUFZLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFDdEcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxTQUFTLEdBQUcsY0FBYyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsU0FBUyxFQUFFLHNCQUFzQixDQUFDLElBQUksQ0FBQyxFQUFFLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUM1SCxJQUFJLENBQUMsY0FBYyxDQUFDLFFBQVEsR0FBRyxjQUFjLENBQUMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxjQUFjLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsY0FBYyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDbEosSUFBSSxDQUFD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bUIsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDNUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLG1CQUFtQixDQUFDLEdBQUcsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDekUsY0FBYyxDQUFDLE1BQU0sRUFBRSxDQUFDO1FBQ3hCLElBQUksQ0FBQyxVQUFVLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDN0UsSUFBSSxDQUFDLFVBQVUsQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLG1CQUFtQixDQUFDLENBQUMsR0FBRyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQztJQUMvRSxDQUFDO0lBRUwscUJBQUM7QUFBRCxDQUFDLEFBL0ZELENBQW9DLG9CQUFFLEdBK0ZyQztBQS9GWSx3Q0FBYyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7QVJ9IGZyb20gJ25hdGl2ZXNjcmlwdC1hcic7XG5cbk9iamVjdC5hc3NpZ24oZ2xvYmFsLCB7XG4gICAgU0NOVmVjdG9yM01ha2UoeCwgeSwgeikge1xuICAgIHJldHVybiBuZXcgU0NOVmVjdG9yMyh7IHgsIHksIHogfSk7XG4gICAgfVxufSlcblxuZXhwb3J0IGNsYXNzIERyb25lU2NlbmVWaWV3IGV4dGVuZHMgQVIge1xuICAgIGhlbGljb3B0ZXJOb2RlOiBTQ05Ob2RlO1xuICAgIGJsYWRlMU5vZGU6IFNDTk5vZGU7XG4gICAgYmxhZGUyTm9kZTogU0NOTm9kZTtcbiAgICByb3RvclI6IFNDTk5vZGU7XG4gICAgcm90b3JMOiBTQ05Ob2RlO1xuXG4gICAgc2V0dXBEcm9uZSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5zY2VuZVZpZXcuc2NlbmUgPSBTQ05TY2VuZS5zY2VuZU5hbWVkKFwiQXNzZXRzLnNjbmFzc2V0cy9Ecm9uZS5zY25cIik7XG4gICAgICAgIHRoaXMuaGVsaWNvcHRlck5vZGUgPSB0aGlzLnNjZW5lVmlldy5zY2VuZS5yb290Tm9kZS5jaGlsZE5vZGVXaXRoTmFtZVJlY3Vyc2l2ZWx5KFwiaGVsaWNvcHRlclwiLCBmYWxzZSk7XG4gICAgICAgIHRoaXMuaGVsaWNvcHRlck5vZGUudHJhbnNmb3JtID0gU0NOTWF0cml4NE11bHQodGhpcy5oZWxpY29wdGVyTm9kZS50cmFuc2Zvcm0sIFNDTk1hdHJpeDRNYWtlUm90YXRpb24oTWF0aC5QSSAvIDIsIDEsIDAsIDApKTtcbiAgICAgICAgdGhpcy5oZWxpY29wdGVyTm9kZS5wb3NpdGlvbiA9IFNDTlZlY3RvcjNNYWtlKHRoaXMuaGVsaWNvcHRlck5vZGUucG9zaXRpb24ueCwgdGhpcy5oZWxpY29wdGVyTm9kZS5wb3NpdGlvbi55LCB0aGlzLmhlbGljb3B0ZXJOb2RlLnBvc2l0aW9uLnogLSAxKTtcbiAgICAgICAgdGhpcy5ibGFkZTFOb2RlID0gdGhpcy5oZWxpY29wdGVyTm9kZS5jaGlsZE5vZGVXaXRoTmFtZVJlY3Vyc2l2ZWx5KFwiUm90b3JfUl8yXCIsIHRydWUpO1xuICAgICAgICB0aGlzLmJsYWRlMk5vZGUgPSB0aGlzLmhlbGljb3B0ZXJOb2RlLmNoaWxkTm9kZVdpdGhOYW1lUmVjdXJzaXZlbHkoXCJSb3Rvcl9MXzJcIiwgIHRydWUpO1xuICAgICAgICB0aGlzLnJvdG9yUiA9IHRoaXMuYmxhZGUxTm9kZS5jaGlsZE5vZGVXaXRoTmFtZVJlY3Vyc2l2ZWx5KFwiUm90b3JfUlwiLCB0cnVlKTtcbiAgICAgICAgdGhpcy5yb3RvckwgPSB0aGlzLmJsYWRlMk5vZGUuY2hpbGROb2RlV2l0aE5hbWVSZWN1cnNpdmVseShcIlJvdG9yX0xcIiwgdHJ1ZSk7XG4gICAgICAgIHRoaXMuc3R5bGVEcm9uZSgpO1xuICAgICAgICB0aGlzLnNwaW5CbGFkZXMoKTtcbiAgICB9XG5cbiAgICBzdHlsZURyb25lKCk6IHZvaWQge1xuICAgICAgICBsZXQgYm9keU1hdGVyaWFsID0gU0NOTWF0ZXJpYWwubmV3KCk7XG4gICAgICAgIGJvZHlNYXRlcmlhbC5kaWZmdXNlLmNvbnRlbnRzID0gVUlDb2xvci5jb2xvcldpdGhSZWRHcmVlbkJsdWVBbHBoYSg2My8yNTUsIDg2LzI1NSwgMjQ3LzI1NSwgMSk7XG4gICAgICAgIHRoaXMuaGVsaWNvcHRlck5vZGUuZ2VvbWV0cnkubWF0ZXJpYWxzID0gTlNBcnJheS5hcnJheVdpdGhBcnJheShbYm9keU1hdGVyaWFsXSk7XG4gICAgICAgIC8vYSBub2RlIG1pZ2h0IGhhdmUgZ2VvbWV0cnkgb2YgbnVsbFxuICAgICAgICAvLyB0aGlzLnNjZW5lVmlldy5zY2VuZS5yb290Tm9kZS5nZW9tZXRyeS5tYXRlcmlhbHMgPSBOU0FycmF5LmFycmF5V2l0aEFycmF5KFtib2R5TWF0ZXJpYWxdKTtcbiAgICAgICAgbGV0IGJsYWRlTWF0ZXJpYWwgPSBTQ05NYXRlcmlhbC5uZXcoKTtcbiAgICAgICAgYmxhZGVNYXRlcmlhbC5kaWZmdXNlLmNvbnRlbnRzID0gVUlDb2xvci5ncmF5Q29sb3I7XG4gICAgICAgIGxldCByb3Rvck1hdGVyaWFsID0gU0NOTWF0ZXJpYWwubmV3KCk7XG4gICAgICAgIHJvdG9yTWF0ZXJpYWwuZGlmZnVzZS5jb250ZW50cyA9IFVJQ29sb3Iud2hpdGVDb2xvcjtcbiAgICAgICAgdGhpcy5ibGFkZTFOb2RlLmdlb21ldHJ5Lm1hdGVyaWFscyA9IE5TQXJyYXkuYXJyYXlXaXRoQXJyYXkoW3JvdG9yTWF0ZXJpYWxdKTtcbiAgICAgICAgdGhpcy5ibGFkZTJOb2RlLmdlb21ldHJ5Lm1hdGVyaWFscyA9IE5TQXJyYXkuYXJyYXlXaXRoQXJyYXkoW3JvdG9yTWF0ZXJpYWxdKTtcbiAgICAgICAgdGhpcy5yb3RvclIuZ2VvbWV0cnkubWF0ZXJpYWxzID0gTlNBcnJheS5hcnJheVdpdGhBcnJheShbYmxhZGVNYXRlcmlhbF0pO1xuICAgICAgICB0aGlzLnJvdG9yTC5nZW9tZXRyeS5tYXRlcmlhbHMgPSBOU0FycmF5LmFycmF5V2l0aEFycmF5KFtibGFkZU1hdGVyaWFsXSk7XG4gICAgfVxuXG4gICAgc3BpbkJsYWRlcygpOiB2b2lkIHtcbiAgICAgICAgbGV0IHJvdGF0ZSA9IFNDTkFjdGlvbi5yb3RhdGVCeVhZWkR1cmF0aW9uKDAsIDAsIDIwMCwgMC41KTtcbiAgICAgICAgbGV0IG1vdmVTZXF1ZW5jZSA9IFNDTkFjdGlvbi5zZXF1ZW5jZShOU0FycmF5LmFycmF5V2l0aEFycmF5KFtyb3RhdGVdKSk7XG4gICAgICAgIGxldCBtb3ZlTG9vcCA9IFNDTkFjdGlvbi5yZXBlYXRBY3Rpb25Gb3JldmVyKG1vdmVTZXF1ZW5jZSk7XG4gICAgICAgIHRoaXMucm90b3JMLnJ1bkFjdGlvbihtb3ZlTG9vcCk7XG4gICAgICAgIHRoaXMucm90b3JSLnJ1bkFjdGlvbihtb3ZlTG9vcCk7XG4gICAgfVxuXG4gICAgY2hhbmdlQWx0aXR1ZGUodmFsdWUpOiB2b2lkIHtcbiAgICAgICAgU0NOVHJhbnNhY3Rpb24uYmVnaW4oKTtcbiAgICAgICAgU0NOVHJhbnNhY3Rpb24uYW5pbWF0aW9uRHVyYXRpb24gPSAwLjU7XG4gICAgICAgIHRoaXMuaGVsaWNvcHRlck5vZGUucG9zaXRpb24gPSBTQ05WZWN0b3IzTWFrZSh0aGlzLmhlbGljb3B0ZXJOb2RlLnBvc2l0aW9uLngsIHZhbHVlLCB0aGlzLmhlbGljb3B0ZXJOb2RlLnBvc2l0aW9uLnopO1xuICAgICAgICBTQ05UcmFuc2FjdGlvbi5jb21taXQoKTtcbiAgICB9XG5cbiAgICBtb3ZlTGVmdCgpIHtcbiAgICAgICAgU0NOVHJhbnNhY3Rpb24uYmVnaW4oKTtcbiAgICAgICAgU0NOVHJhbnNhY3Rpb24uYW5pbWF0aW9uRHVyYXRpb24gPSAwLjU7XG4gICAgICAgIHRoaXMuaGVsaWNvcHRlck5vZGUucG9zaXRpb24gPSBTQ05WZWN0b3IzTWFrZSh0aGlzLmhlbGljb3B0ZXJOb2RlLnBvc2l0aW9uLnggLSAwLjUsIHRoaXMuaGVsaWNvcHRlck5vZGUucG9zaXRpb24ueSwgdGhpcy5oZWxpY29wdGVyTm9kZS5wb3NpdGlvbi56KTtcbiAgICAgICAgdGhpcy5ibGFkZTJOb2RlLnJ1bkFjdGlvbihTQ05BY3Rpb24ucm90YXRlQnlYWVpEdXJhdGlvbigwLjMsIC0wLjEsIDAsIDEuNSkpO1xuICAgICAgICB0aGlzLmJsYWRlMU5vZGUucnVuQWN0aW9uKFNDTkFjdGlvbi5yb3RhdGVCeVhZWkR1cmF0aW9uKDAuMywgMCwgMCwgMS41KSk7XG4gICAgICAgIFNDTlRyYW5zYWN0aW9uLmNvbW1pdCgpO1xuICAgICAgICB0aGlzLmJsYWRlMk5vZGUucnVuQWN0aW9uKFNDTkFjdGlvbi5yb3RhdGVCeVhZWkR1cmF0aW9uKC0wLjMsIDAuMSwgMCwgMC4yNSkpO1xuICAgICAgICB0aGlzLmJsYWRlMU5vZGUucnVuQWN0aW9uKFNDTkFjdGlvbi5yb3RhdGVCeVhZWkR1cmF0aW9uKC0wLjMsIDAsIDAsIDAuMjUpKSA7XG4gICAgfVxuXG4gICAgbW92ZVJpZ2h0KCkge1xuICAgICAgICBTQ05UcmFuc2FjdGlvbi5iZWdpbigpO1xuICAgICAgICBTQ05UcmFuc2FjdGlvbi5hbmltYXRpb25EdXJhdGlvbiA9IDAuNTtcbiAgICAgICAgdGhpcy5oZWxpY29wdGVyTm9kZS5wb3NpdGlvbiA9IFNDTlZlY3RvcjNNYWtlKHRoaXMuaGVsaWNvcHRlck5vZGUucG9zaXRpb24ueCArIDAuNSwgdGhpcy5oZWxpY29wdGVyTm9kZS5wb3NpdGlvbi55LCB0aGlzLmhlbGljb3B0ZXJOb2RlLnBvc2l0aW9uLnopO1xuICAgICAgICB0aGlzLmJsYWRlMk5vZGUucnVuQWN0aW9uKFNDTkFjdGlvbi5yb3RhdGVCeVhZWkR1cmF0aW9uKDAuMywgLTAuMSwgMCwgMS41KSk7XG4gICAgICAgIHRoaXMuYmxhZGUxTm9kZS5ydW5BY3Rpb24oU0NOQWN0aW9uLnJvdGF0ZUJ5WFlaRHVyYXRpb24oMC4zLCAwLCAwLCAxLjUpKTtcbiAgICAgICAgU0NOVHJhbnNhY3Rpb24uY29tbWl0KCk7XG4gICAgICAgIHRoaXMuYmxhZGUyTm9kZS5ydW5BY3Rpb24oU0NOQWN0aW9uLnJvdGF0ZUJ5WFlaRHVyYXRpb24oLTAuMywgMC4xLCAwLCAwLjI1KSk7XG4gICAgICAgIHRoaXMuYmxhZGUxTm9kZS5ydW5BY3Rpb24oU0NOQWN0aW9uLnJvdGF0ZUJ5WFlaRHVyYXRpb24oLTAuMywgMCwgMCwgMC4yNSkpO1xuICAgIH1cblxuICAgIG1vdmVGb3J3YXJkKCkge1xuICAgICAgICBTQ05UcmFuc2FjdGlvbi5iZWdpbigpO1xuICAgICAgICBTQ05UcmFuc2FjdGlvbi5hbmltYXRpb25EdXJhdGlvbiA9IDAuNTtcbiAgICAgICAgdGhpcy5oZWxpY29wdGVyTm9kZS5wb3NpdGlvbiA9IFNDTlZlY3RvcjNNYWtlKHRoaXMuaGVsaWNvcHRlck5vZGUucG9zaXRpb24ueCwgdGhpcy5oZWxpY29wdGVyTm9kZS5wb3NpdGlvbi55LCB0aGlzLmhlbGljb3B0ZXJOb2RlLnBvc2l0aW9uLnogLSAwLjUpO1xuICAgICAgICB0aGlzLmJsYWRlMk5vZGUucnVuQWN0aW9uKFNDTkFjdGlvbi5yb3RhdGVCeVhZWkR1cmF0aW9uKDAuMywgLTAuMSwgMCwgMS41KSk7XG4gICAgICAgIHRoaXMuYmxhZGUxTm9kZS5ydW5BY3Rpb24oU0NOQWN0aW9uLnJvdGF0ZUJ5WFlaRHVyYXRpb24oMC4zLCAwLCAwLCAxLjUpKTtcbiAgICAgICAgU0NOVHJhbnNhY3Rpb24uY29tbWl0KCk7XG4gICAgICAgIHRoaXMuYmxhZGUyTm9kZS5ydW5BY3Rpb24oU0NOQWN0aW9uLnJvdGF0ZUJ5WFlaRHVyYXRpb24oLTAuMywgMC4xLCAwLCAwLjI1KSk7XG4gICAgICAgIHRoaXMuYmxhZGUxTm9kZS5ydW5BY3Rpb24oU0NOQWN0aW9uLnJvdGF0ZUJ5WFlaRHVyYXRpb24oLTAuMywgMCwgMCwgMC4yNSkpO1xuICAgIH1cblxuICAgIG1vdmVCYWNrKCkge1xuICAgICAgICBTQ05UcmFuc2FjdGlvbi5iZWdpbigpO1xuICAgICAgICBTQ05UcmFuc2FjdGlvbi5hbmltYXRpb25EdXJhdGlvbiA9IDAuNTtcbiAgICAgICAgdGhpcy5oZWxpY29wdGVyTm9kZS5wb3NpdGlvbiA9IFNDTlZlY3RvcjNNYWtlKHRoaXMuaGVsaWNvcHRlck5vZGUucG9zaXRpb24ueCwgdGhpcy5oZWxpY29wdGVyTm9kZS5wb3NpdGlvbi55LCB0aGlzLmhlbGljb3B0ZXJOb2RlLnBvc2l0aW9uLnogKyAwLjUpO1xuICAgICAgICB0aGlzLmJsYWRlMk5vZGUucnVuQWN0aW9uKFNDTkFjdGlvbi5yb3RhdGVCeVhZWkR1cmF0aW9uKDAuMywgLTAuMSwgMCwgMS41KSk7XG4gICAgICAgIHRoaXMuYmxhZGUxTm9kZS5ydW5BY3Rpb24oU0NOQWN0aW9uLnJvdGF0ZUJ5WFlaRHVyYXRpb24oMC4zLCAwLCAwLCAxLjUpKTtcbiAgICAgICAgU0NOVHJhbnNhY3Rpb24uY29tbWl0KCk7XG4gICAgICAgIHRoaXMuYmxhZGUyTm9kZS5ydW5BY3Rpb24oU0NOQWN0aW9uLnJvdGF0ZUJ5WFlaRHVyYXRpb24oLTAuMywgMC4xLCAwLCAwLjI1KSk7XG4gICAgICAgIHRoaXMuYmxhZGUxTm9kZS5ydW5BY3Rpb24oU0NOQWN0aW9uLnJvdGF0ZUJ5WFlaRHVyYXRpb24oLTAuMywgMCwgMCwgMC4yNSkpO1xuICAgIH1cbiAgICBcbn0iXX0=